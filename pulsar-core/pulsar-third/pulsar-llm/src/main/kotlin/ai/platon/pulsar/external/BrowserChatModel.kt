package ai.platon.pulsar.external

import ai.platon.pulsar.dom.FeaturedDocument
import org.jsoup.nodes.Element

interface BrowserChatModel {
    val settings: ChatModelSettings

    /**
     * Generates a response from the model based on a sequence of messages.
     * Typically, the sequence contains messages in the following order:
     * System (optional) - User - AI - User - AI - User ...
     *
     * @return The response generated by the model.
     */
    suspend fun call(userMessage: String): ModelResponse

    /**
     * Call the model to generate a response based on a sequence of messages and attachment.
     * Typically, the sequence contains messages in the following order:
     * System (optional) - User - AI - User - AI - User ...
     *
     * @param systemMessage The system message.
     * @param userMessage The user message.
     * @param imageUrl The imageUrl.
     * @param b64Image The image in base64 format.
     * @param mediaType The media type of the image.
     * @return The response generated by the model.
     */
    suspend fun call(
        systemMessage: String, userMessage: String, imageUrl: String? = null, b64Image: String?= null, mediaType: String?= null
    ): ModelResponse = callUmSm(userMessage, systemMessage, imageUrl, mediaType, b64Image)

    /**
     * Call the model to generate a response based on a sequence of messages and attachment.
     * Typically, the sequence contains messages in the following order:
     * System (optional) - User - AI - User - AI - User ...
     *
     * @param systemMessage The system message.
     * @param userMessage The user message.
     * @param imageUrl The imageUrl.
     * @param b64Image The image in base64 format.
     * @param mediaType The media type of the image.
     * @return The response generated by the model.
     */
    suspend fun callSmUm(
        systemMessage: String, userMessage: String, imageUrl: String? = null, b64Image: String?= null, mediaType: String?= null
    ): ModelResponse

    /**
     * Call the model to generate a response based on a sequence of messages and attachment.
     * Typically, the sequence contains messages in the following order:
     * System (optional) - User - AI - User - AI - User ...
     *
     * @param userMessage The user message.
     * @param systemMessage The system message.
     * @param imageUrl The imageUrl.
     * @param b64Image The image in base64 format.
     * @param mediaType The media type of the image.
     * @return The response generated by the model.
     */
    suspend fun callUmSm(
        userMessage: String, systemMessage: String, imageUrl: String? = null, b64Image: String?= null, mediaType: String?= null
    ): ModelResponse

    /**
     * Generates a response from the model based on a sequence of messages.
     * Typically, the sequence contains messages in the following order:
     * System (optional) - User - AI - User - AI - User ...
     *
     * @param document An array of messages.
     * @return The response generated by the model.
     */
    suspend fun call(document: FeaturedDocument, prompt: String): ModelResponse

    /**
     * Generates a response from the model based on a sequence of messages.
     * Typically, the sequence contains messages in the following order:
     * System (optional) - User - AI - User - AI - User ...
     *
     * @param ele The Element to ask.
     * @return The response generated by the model.
     */
    suspend fun call(ele: Element, prompt: String): ModelResponse
}
